<view class="container">
  <!-- 加载状态 -->
  <view wx:if="{{loading}}" class="loading-container">
    <van-loading type="spinner" color="#07c160" />
    <text class="loading-text">加载中...</text>
  </view>

  <!-- 表单内容 -->
  <view wx:else>
    <!-- 头像部分 -->
    <view class="avatar-section">
      <text class="section-label">头像</text>
      <van-uploader 
        file-list="{{avatarList}}" 
        bind:after-read="onAvatarRead" 
        max-count="1" 
        accept="image" 
        preview-size="80px" />
    </view>

    <!-- 基本信息 -->
    <view class="form-section">
      <view class="section-title">基本信息</view>
      <van-field 
        label="昵称" 
        value="{{nickname}}" 
        placeholder="请输入昵称" 
        bind:input="onNicknameChange" 
        required />
      <van-field 
        label="性别" 
        value="{{genderText}}" 
        placeholder="请选择性别" 
        is-link 
        readonly 
        bind:tap="showGenderPicker" />
      <van-field 
        label="手机号" 
        value="{{phone}}" 
        disabled 
        readonly />
      <van-field 
        label="真实姓名" 
        value="{{realName}}" 
        placeholder="请输入真实姓名" 
        bind:input="onRealNameChange" />
    </view>

    <!-- 地址信息 -->
    <view class="form-section">
      <view class="section-title">地址信息</view>
      <van-field 
        label="省份" 
        value="{{province}}" 
        placeholder="请输入省份" 
        bind:input="onProvinceChange" />
      <van-field 
        label="城市" 
        value="{{city}}" 
        placeholder="请输入城市" 
        bind:input="onCityChange" />
      <van-field 
        label="区县" 
        value="{{district}}" 
        placeholder="请输入区县" 
        bind:input="onDistrictChange" />
      <van-field 
        label="详细地址" 
        value="{{address}}" 
        placeholder="请输入详细地址" 
        type="textarea" 
        autosize 
        bind:input="onAddressChange" />
    </view>

    <!-- 保存按钮 -->
    <view class="submit-section">
      <van-button 
        block 
        round 
        color="#07c160" 
        bind:click="onSave">
        保存
      </van-button>
    </view>
  </view>

  <!-- 性别选择器 -->
  <van-popup 
    show="{{showGender}}" 
    position="bottom" 
    bind:close="closeGenderPicker" 
    round
    closeable>
    <van-picker 
      title="选择性别"
      show-toolbar
      columns="{{genders}}"
      default-index="{{gender}}"
      bind:confirm="onGenderConfirm" 
      bind:cancel="closeGenderPicker" />
  </van-popup>

</view>
