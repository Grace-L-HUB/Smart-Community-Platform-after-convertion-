<view class="container" wx:if="{{!loading}}">
  <!-- Event Banner -->
  <image
    class="event-banner"
    src="{{event.image || 'https://picsum.photos/seed/' + event.id + '/750/400'}}"
    mode="aspectFill"
  ></image>

  <!-- Event Info -->
  <view class="card event-info">
    <text class="event-title">{{event.title}}</text>

    <view class="info-row">
      <van-icon name="clock-o" size="18px" color="#07c160" />
      <text class="info-text">{{event.startTime}} - {{event.endTime}}</text>
    </view>

    <view class="info-row">
      <van-icon name="location-o" size="18px" color="#07c160" />
      <text class="info-text">{{event.location}}</text>
    </view>

    <view class="info-row">
      <van-icon name="eye-o" size="18px" color="#07c160" />
      <text class="info-text">{{event.viewCount}} 次浏览</text>
    </view>

    <view class="tags-row">
      <van-tag type="{{event.statusColor || 'default'}}">{{event.statusText}}</van-tag>
    </view>

    <!-- 报名进度条 -->
    <view class="progress-section" wx:if="{{event.maxParticipants > 0}}">
      <view class="progress-header">
        <text class="progress-text">报名进度</text>
        <text class="progress-count">{{event.currentParticipants}}/{{event.maxParticipants}}人</text>
      </view>
      <van-progress
        percentage="{{event.registrationProgress}}"
        stroke-width="6"
        color="#07c160"
        inactive-color="#f2f3f5"
        show-pivot="{{false}}"
      />
    </view>
  </view>

  <!-- Event Description -->
  <view class="card desc-section" wx:if="{{event.description}}">
    <view class="section-title">活动详情</view>
    <text class="desc-text">{{event.description}}</text>
  </view>

  <!-- Organizer Info -->
  <view class="card organizer-section">
    <view class="section-title">组织者</view>
    <view class="organizer-info">
      <image
        class="organizer-avatar"
        src="{{event.organizerAvatar}}"
        binderror="onImageError"
      ></image>
      <view class="organizer-details">
        <text class="organizer-name">{{event.organizer}}</text>
        <text class="organizer-time">发布于 {{event.createdAt}}</text>
      </view>
    </view>
  </view>

  <!-- Action Button -->
  <view class="action-bar">
    <van-button
      block
      round
      color="{{isRegistered ? '#ff6b6b' : '#07c160'}}"
      bind:click="{{isRegistered ? 'onCancelRegistration' : 'onJoinEvent'}}"
      disabled="{{!isRegistered && !canRegister}}"
    >
      {{isRegistered ? '取消报名' : (canRegister ? '立即报名' : '暂不可报名')}}
    </van-button>
  </view>
</view>

<!-- Loading -->
<van-loading wx:if="{{loading}}" type="spinner" color="#07c160" vertical>加载中...</van-loading>