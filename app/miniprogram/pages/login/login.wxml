<view class="container">
  <view class="header">
    <image class="logo" src="/image/logo/logo.png" mode="aspectFit"></image>
    <text class="title">智慧社区</text>
  </view>

  <!-- 登录主要区域 -->
  <view class="login-box" wx:if="{{!showProfileInput}}">
    
    <!-- 手机号登录表单 -->
    <view class="form-area">
      <view class="input-group">
        <text class="label">手机号</text>
        <input class="input" type="number" placeholder="请输入手机号" maxlength="11" bindinput="onPhoneInput" value="{{phone}}" />
      </view>
      <view class="input-group code-group">
        <text class="label">验证码</text>
        <input class="input" type="number" placeholder="输入验证码" maxlength="6" bindinput="onCodeInput" value="{{code}}" />
        <view class="get-code-btn" bindtap="getVerificationCode">获取验证码</view>
      </view>

      <button class="btn-primary" bindtap="handlePhoneLogin">登录</button>
    </view>

    <view class="divider">
      <view class="line"></view>
      <text class="text">其他方式</text>
      <view class="line"></view>
    </view>

    <view class="social-login">
      <button class="btn-wechat" bindtap="handleWechatLogin">
        微信一键登录
      </button>
    </view>
  </view>

  <!-- 用户信息完善区域 (类似 index 页面的逻辑) -->
  <view class="profile-box" wx:else>
    <view class="profile-header">
      <text class="profile-title">完善个人信息</text>
      <text class="profile-desc">新用户请完善头像和昵称</text>
    </view>

    <view class="avatar-section">
      <button class="avatar-wrapper" open-type="chooseAvatar" bind:chooseavatar="onChooseAvatar">
        <image class="avatar-img" src="{{userInfo.avatarUrl}}"></image>
        <view class="avatar-edit-icon">+</view>
      </button>
      <text class="avatar-tip">点击修改头像</text>
    </view>

    <view class="nickname-section">
      <text class="label">昵称</text>
      <input type="nickname" class="input nickname-input" placeholder="请输入昵称" bind:change="onNicknameChange" value="{{userInfo.nickName}}"/>
    </view>

    <button class="btn-primary" bindtap="handleSubmitProfile">完成并登录</button>
    <button class="btn-secondary" bindtap="cancelProfileUpdate">返回</button>
  </view>

</view>
