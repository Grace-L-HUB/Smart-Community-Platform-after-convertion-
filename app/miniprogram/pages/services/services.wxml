<view class="container">
  <van-tabs active="{{ active }}" color="#07c160" sticky>
    <!-- Tab 1: Property Services -->
    <van-tab title="物业服务">
      <view class="p-30">
        <view class="section-card">
          <view class="card-title">基础服务</view>
          <van-grid column-num="3" border="{{ false }}">
            <van-grid-item icon="volume-o" text="社区公告" link-type="navigateTo" url="/pages/services/announcements/announcements" />
            <van-grid-item icon="wap-home-o" text="房屋管理" link-type="navigateTo" url="/pages/house/index/index" />
            <van-grid-item icon="manager-o" text="访客管理" link-type="navigateTo" url="/pages/services/visitor/visitor" />
            <van-grid-item icon="setting-o" text="报事报修" link-type="navigateTo" url="/pages/repair/repair" />
            <van-grid-item icon="balance-list-o" text="物业缴费" link-type="navigateTo" url="/pages/payment/payment" />
            <van-grid-item icon="column" text="装修申请" link-type="navigateTo" url="/pages/services/decoration/decoration" />
          </van-grid>
        </view>

        <view class="section-card mt-20">
          <view class="card-title">便民服务</view>
          <van-grid column-num="4" border="{{ false }}">
             <van-grid-item icon="flower-o" text="家政保洁" link-type="navigateTo" url="/pages/services/housekeeping/housekeeping" />
             <van-grid-item icon="coupon-o" text="优惠券" link-type="navigateTo" url="/pages/coupon/market/market" />
             <van-grid-item icon="bell" text="物业通知" link-type="navigateTo" url="/pages/notification/notification" />
             <van-grid-item icon="phone-circle-o" text="常用电话" link-type="navigateTo" url="/pages/services/contacts/contacts" />
          </van-grid>
        </view>
      </view>
    </van-tab>

    <!-- Tab 2: Life Services -->
    <van-tab title="街角好店">
      <view class="p-30">
        <!-- 加载状态 -->
        <van-loading wx:if="{{ loading }}" type="spinner" color="#1989fa" vertical>
          加载中...
        </van-loading>
        
        <!-- 错误状态 -->
        <view wx:elif="{{ error }}" class="error-container">
          <van-empty description="{{ error }}">
            <van-button round type="primary" class="bottom-button" bindtap="onRefresh">
              重新加载
            </van-button>
          </van-empty>
        </view>
        
        <!-- 商户列表 -->
        <block wx:else>
          <view wx:if="{{ shops.length === 0 }}" class="empty-container">
            <van-empty description="暂无商户" />
          </view>
          
          <view wx:else>
            <block wx:for="{{ shops }}" wx:key="id">
              <view class="shop-card" data-id="{{ item.id }}" bindtap="onShopClick">
                <image class="shop-img" src="{{ item.image }}" mode="aspectFill" lazy-load />
                <view class="shop-content">
                  <view class="shop-main-info">
                    <view class="shop-title-row">
                      <text class="shop-title text-ellipsis">{{ item.name }}</text>
                    </view>
                    <view class="shop-tags">
                      <text class="tag category-tag" wx:if="{{ item.category }}">{{ item.category }}</text>
                      <text class="tag discount-tag" wx:if="{{ item.discount }}">{{ item.discount }}</text>
                    </view>
                    <view class="shop-desc text-ellipsis">{{ item.desc }}</view>
                    <view class="shop-extra">
                      <van-icon name="clock-o" size="12" color="#999" style="margin-right: 4rpx;" />
                      <text>{{ item.price }}</text> <!-- price field holds business hours text -->
                    </view>
                  </view>
                  <view class="shop-action">
                    <button class="visit-btn">进店</button>
                  </view>
                </view>
              </view>
              <view style="height: 20rpx;"></view>
            </block>
          </view>
        </block>
      </view>
    </van-tab>
  </van-tabs>
</view>
